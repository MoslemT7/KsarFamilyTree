{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * Copyright (c) \"Neo4j\"\n * Neo4j Sweden AB [https://neo4j.com]\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar routing_table_1 = __importDefault(require(\"./routing-table\"));\n// eslint-disable-next-line no-unused-vars\nvar neo4j_driver_core_1 = require(\"neo4j-driver-core\");\nvar Rediscovery = /** @class */function () {\n  /**\n   * @constructor\n   * @param {object} routingContext\n   */\n  function Rediscovery(routingContext) {\n    this._routingContext = routingContext;\n  }\n  /**\n   * Try to fetch new routing table from the given router.\n   * @param {Session} session the session to use.\n   * @param {string} database the database for which to lookup routing table.\n   * @param {ServerAddress} routerAddress the URL of the router.\n   * @param {string} impersonatedUser The impersonated user\n   * @return {Promise<RoutingTable>} promise resolved with new routing table or null when connection error happened.\n   */\n  Rediscovery.prototype.lookupRoutingTableOnRouter = function (session, database, routerAddress, impersonatedUser) {\n    var _this = this;\n    return session._acquireConnection(function (connection) {\n      return _this._requestRawRoutingTable(connection, session, database, routerAddress, impersonatedUser).then(function (rawRoutingTable) {\n        if (rawRoutingTable.isNull) {\n          return null;\n        }\n        return routing_table_1.default.fromRawRoutingTable(database, routerAddress, rawRoutingTable);\n      });\n    });\n  };\n  Rediscovery.prototype._requestRawRoutingTable = function (connection, session, database, routerAddress, impersonatedUser) {\n    var _this = this;\n    return new Promise(function (resolve, reject) {\n      connection.protocol().requestRoutingInformation({\n        routingContext: _this._routingContext,\n        databaseName: database,\n        impersonatedUser: impersonatedUser,\n        sessionContext: {\n          bookmarks: session._lastBookmarks,\n          mode: session._mode,\n          database: session._database,\n          afterComplete: session._onComplete\n        },\n        onCompleted: resolve,\n        onError: reject\n      });\n    });\n  };\n  return Rediscovery;\n}();\nexports.default = Rediscovery;","map":{"version":3,"names":["__importDefault","mod","__esModule","Object","defineProperty","exports","value","routing_table_1","require","neo4j_driver_core_1","Rediscovery","routingContext","_routingContext","prototype","lookupRoutingTableOnRouter","session","database","routerAddress","impersonatedUser","_this","_acquireConnection","connection","_requestRawRoutingTable","then","rawRoutingTable","isNull","default","fromRawRoutingTable","Promise","resolve","reject","protocol","requestRoutingInformation","databaseName","sessionContext","bookmarks","_lastBookmarks","mode","_mode","_database","afterComplete","_onComplete","onCompleted","onError"],"sources":["D:/Study/Projects/Copy 4/client/node_modules/neo4j-driver-bolt-connection/lib/rediscovery/rediscovery.js"],"sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Copyright (c) \"Neo4j\"\n * Neo4j Sweden AB [https://neo4j.com]\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar routing_table_1 = __importDefault(require(\"./routing-table\"));\n// eslint-disable-next-line no-unused-vars\nvar neo4j_driver_core_1 = require(\"neo4j-driver-core\");\nvar Rediscovery = /** @class */ (function () {\n    /**\n     * @constructor\n     * @param {object} routingContext\n     */\n    function Rediscovery(routingContext) {\n        this._routingContext = routingContext;\n    }\n    /**\n     * Try to fetch new routing table from the given router.\n     * @param {Session} session the session to use.\n     * @param {string} database the database for which to lookup routing table.\n     * @param {ServerAddress} routerAddress the URL of the router.\n     * @param {string} impersonatedUser The impersonated user\n     * @return {Promise<RoutingTable>} promise resolved with new routing table or null when connection error happened.\n     */\n    Rediscovery.prototype.lookupRoutingTableOnRouter = function (session, database, routerAddress, impersonatedUser) {\n        var _this = this;\n        return session._acquireConnection(function (connection) {\n            return _this._requestRawRoutingTable(connection, session, database, routerAddress, impersonatedUser).then(function (rawRoutingTable) {\n                if (rawRoutingTable.isNull) {\n                    return null;\n                }\n                return routing_table_1.default.fromRawRoutingTable(database, routerAddress, rawRoutingTable);\n            });\n        });\n    };\n    Rediscovery.prototype._requestRawRoutingTable = function (connection, session, database, routerAddress, impersonatedUser) {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            connection.protocol().requestRoutingInformation({\n                routingContext: _this._routingContext,\n                databaseName: database,\n                impersonatedUser: impersonatedUser,\n                sessionContext: {\n                    bookmarks: session._lastBookmarks,\n                    mode: session._mode,\n                    database: session._database,\n                    afterComplete: session._onComplete\n                },\n                onCompleted: resolve,\n                onError: reject\n            });\n        });\n    };\n    return Rediscovery;\n}());\nexports.default = Rediscovery;\n"],"mappings":"AAAA,YAAY;;AACZ,IAAIA,eAAe,GAAI,IAAI,IAAI,IAAI,CAACA,eAAe,IAAK,UAAUC,GAAG,EAAE;EACnE,OAAQA,GAAG,IAAIA,GAAG,CAACC,UAAU,GAAID,GAAG,GAAG;IAAE,SAAS,EAAEA;EAAI,CAAC;AAC7D,CAAC;AACDE,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAAEC,KAAK,EAAE;AAAK,CAAC,CAAC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAIC,eAAe,GAAGP,eAAe,CAACQ,OAAO,CAAC,iBAAiB,CAAC,CAAC;AACjE;AACA,IAAIC,mBAAmB,GAAGD,OAAO,CAAC,mBAAmB,CAAC;AACtD,IAAIE,WAAW,GAAG,aAAe,YAAY;EACzC;AACJ;AACA;AACA;EACI,SAASA,WAAWA,CAACC,cAAc,EAAE;IACjC,IAAI,CAACC,eAAe,GAAGD,cAAc;EACzC;EACA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;EACID,WAAW,CAACG,SAAS,CAACC,0BAA0B,GAAG,UAAUC,OAAO,EAAEC,QAAQ,EAAEC,aAAa,EAAEC,gBAAgB,EAAE;IAC7G,IAAIC,KAAK,GAAG,IAAI;IAChB,OAAOJ,OAAO,CAACK,kBAAkB,CAAC,UAAUC,UAAU,EAAE;MACpD,OAAOF,KAAK,CAACG,uBAAuB,CAACD,UAAU,EAAEN,OAAO,EAAEC,QAAQ,EAAEC,aAAa,EAAEC,gBAAgB,CAAC,CAACK,IAAI,CAAC,UAAUC,eAAe,EAAE;QACjI,IAAIA,eAAe,CAACC,MAAM,EAAE;UACxB,OAAO,IAAI;QACf;QACA,OAAOlB,eAAe,CAACmB,OAAO,CAACC,mBAAmB,CAACX,QAAQ,EAAEC,aAAa,EAAEO,eAAe,CAAC;MAChG,CAAC,CAAC;IACN,CAAC,CAAC;EACN,CAAC;EACDd,WAAW,CAACG,SAAS,CAACS,uBAAuB,GAAG,UAAUD,UAAU,EAAEN,OAAO,EAAEC,QAAQ,EAAEC,aAAa,EAAEC,gBAAgB,EAAE;IACtH,IAAIC,KAAK,GAAG,IAAI;IAChB,OAAO,IAAIS,OAAO,CAAC,UAAUC,OAAO,EAAEC,MAAM,EAAE;MAC1CT,UAAU,CAACU,QAAQ,CAAC,CAAC,CAACC,yBAAyB,CAAC;QAC5CrB,cAAc,EAAEQ,KAAK,CAACP,eAAe;QACrCqB,YAAY,EAAEjB,QAAQ;QACtBE,gBAAgB,EAAEA,gBAAgB;QAClCgB,cAAc,EAAE;UACZC,SAAS,EAAEpB,OAAO,CAACqB,cAAc;UACjCC,IAAI,EAAEtB,OAAO,CAACuB,KAAK;UACnBtB,QAAQ,EAAED,OAAO,CAACwB,SAAS;UAC3BC,aAAa,EAAEzB,OAAO,CAAC0B;QAC3B,CAAC;QACDC,WAAW,EAAEb,OAAO;QACpBc,OAAO,EAAEb;MACb,CAAC,CAAC;IACN,CAAC,CAAC;EACN,CAAC;EACD,OAAOpB,WAAW;AACtB,CAAC,CAAC,CAAE;AACJL,OAAO,CAACqB,OAAO,GAAGhB,WAAW","ignoreList":[]},"metadata":{},"sourceType":"script"}