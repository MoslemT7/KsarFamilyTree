{"ast":null,"code":"import React,{useEffect,useState}from'react';import Tree from'react-d3-tree';import'./FamilyTree.css';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const translations=require('./translation.json');let uniqueKeyCounter=0;export const translateName=name=>{return translations[name]||name;};const renderFamilyTree=function(person){let parentId=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;let level=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;const uniqueKey=`${person.name}-${person.lastName}-${parentId}-${level}-${uniqueKeyCounter++}`;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"strong\",{children:[person.name,\" \",person.lastName]})}),person.children&&person.children.length>0&&/*#__PURE__*/_jsx(\"div\",{style:{marginLeft:'20px'},children:person.children.map(child=>renderFamilyTree(child,person.id,level+1))})]},uniqueKey);};const fetchFamilyTree=async()=>{try{const response=await fetch('http://localhost:5000/api/family-tree');if(!response.ok){throw new Error('Server error');}const data=await response.json();// Parse JSON if response is valid\nreturn data;}catch(error){console.error('Error fetching family tree:',error.message);return[];}};const formatFamilyTreeData=person=>{const children=person.children&&person.children.length>0?person.children.map(formatFamilyTreeData)// Recursively format children\n:[];return{name:`${person.name} ${person.lastName}`,children:children// Include children for each person\n};};const getChildrenOfFather=(fatherId,allPeople)=>{const father=allPeople.filter(father=>father.id===fatherId)[0];return father&&father.children?father.children:[];};const buildTree=(person,allPeople)=>{if(!person)return null;const children=getChildrenOfFather(person.id,allPeople).map(child=>buildTree(child,allPeople)).filter(Boolean);return{name:translateName(person.name),children:children.length>0?children:undefined};};const FamilyTree=()=>{const[familyTree,setFamilyTree]=useState(null);const[highlightedNodes,setHighlightedNodes]=useState([]);// const treeRef = useRef();\nuseEffect(()=>{const loadFamilyTree=async()=>{try{const people=await fetchFamilyTree();if(Array.isArray(people)&&people.length>0){const rootPerson=people.find(p=>p.id===17);const treeData=buildTree(rootPerson,people);setFamilyTree(treeData);}else{console.warn(\"Empty or invalid people data\");}}catch(error){console.error('Error loading family tree:',error);}};loadFamilyTree();},[]);if(!familyTree)return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});return/*#__PURE__*/_jsx(\"div\",{id:\"treeWrapper\",style:{width:'100vw',height:'100vh'},children:/*#__PURE__*/_jsx(Tree,{data:familyTree,orientation:\"vertical\",width:1000,height:800,pathFunc:\"step\",renderCustomNodeElement:_ref=>{let{nodeDatum}=_ref;return/*#__PURE__*/_jsxs(\"g\",{children:[/*#__PURE__*/_jsx(\"rect\",{x:\"-50\"// Adjust X position\n,y:\"-20\"// Adjust Y position\n,width:\"100\"// Width of the rectangle\n,height:\"40\"// Height of the rectangle\n,fill:\"lightblue\"// Background color\n,stroke:\"black\"// Border color\n,strokeWidth:\"2\"// Border width\n,rx:\"10\"// Rounded corners\n}),/*#__PURE__*/_jsx(\"text\",{x:\"0\"// Center the text horizontally\n,y:\"5\"// Adjust text position vertically\n,fontSize:\"24\",textAnchor:\"middle\"// Align text to the center\n,fill:\"black\"// Text color\n,children:nodeDatum.name})]});}})});};export default FamilyTree;","map":{"version":3,"names":["React","useEffect","useState","Tree","jsxs","_jsxs","jsx","_jsx","translations","require","uniqueKeyCounter","translateName","name","renderFamilyTree","person","parentId","arguments","length","undefined","level","uniqueKey","lastName","children","style","marginLeft","map","child","id","fetchFamilyTree","response","fetch","ok","Error","data","json","error","console","message","formatFamilyTreeData","getChildrenOfFather","fatherId","allPeople","father","filter","buildTree","Boolean","FamilyTree","familyTree","setFamilyTree","highlightedNodes","setHighlightedNodes","loadFamilyTree","people","Array","isArray","rootPerson","find","p","treeData","warn","width","height","orientation","pathFunc","renderCustomNodeElement","_ref","nodeDatum","x","y","fill","stroke","strokeWidth","rx","fontSize","textAnchor"],"sources":["D:/Study/Projects/El-Kasr Family Tree/client/src/components/FamilyTree.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport Tree from 'react-d3-tree';\r\nimport './FamilyTree.css';\r\nconst translations = require('./translation.json');\r\n\r\nlet uniqueKeyCounter = 0;\r\nexport const translateName = (name) => {\r\n  return translations[name] || name;\r\n};\r\n\r\nconst renderFamilyTree = (person, parentId = null, level = 0) => {\r\n  const uniqueKey = `${person.name}-${person.lastName}-${parentId}-${level}-${uniqueKeyCounter++}`;\r\n\r\n  return (\r\n    <div key={uniqueKey}>\r\n      <div>\r\n        <strong>{person.name} {person.lastName}</strong>\r\n      </div>\r\n      {person.children && person.children.length > 0 && (\r\n        <div style={{ marginLeft: '20px' }}>\r\n          {person.children.map((child) => renderFamilyTree(child, person.id, level + 1))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst fetchFamilyTree = async () => {\r\n  try {\r\n    const response = await fetch('http://localhost:5000/api/family-tree');\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Server error');\r\n    }\r\n\r\n    const data = await response.json(); // Parse JSON if response is valid\r\n    return data;\r\n  } catch (error) {\r\n    console.error('Error fetching family tree:', error.message);\r\n    return [];\r\n  }\r\n};\r\n\r\nconst formatFamilyTreeData = (person) => {\r\n  const children = person.children && person.children.length > 0\r\n    ? person.children.map(formatFamilyTreeData) // Recursively format children\r\n    : [];\r\n\r\n  return {\r\n    name: `${person.name} ${person.lastName}`,\r\n    children: children // Include children for each person\r\n  };\r\n};\r\n\r\nconst getChildrenOfFather = (fatherId, allPeople) => {\r\n  const father = allPeople.filter(father => father.id === fatherId)[0];  \r\n  return father && father.children ? father.children : [];  \r\n};\r\n\r\n\r\nconst buildTree = (person, allPeople) => {\r\n  if (!person) return null;\r\n\r\n  const children = getChildrenOfFather(person.id, allPeople)\r\n    .map(child => buildTree(child, allPeople))\r\n    .filter(Boolean); \r\n\r\n    \r\n  return {\r\n    name: translateName(person.name),\r\n    children: children.length > 0 ? children : undefined, \r\n  };\r\n};\r\n\r\nconst FamilyTree = () => {\r\n  const [familyTree, setFamilyTree] = useState(null);\r\n  const [highlightedNodes, setHighlightedNodes] = useState([]);\r\n  // const treeRef = useRef();\r\n\r\n  useEffect(() => {\r\n    const loadFamilyTree = async () => {\r\n      try {\r\n        const people = await fetchFamilyTree();\r\n\r\n        if (Array.isArray(people) && people.length > 0) {\r\n          const rootPerson = people.find(p => p.id === 17);\r\n\r\n          const treeData = buildTree(rootPerson, people); \r\n          setFamilyTree(treeData);                      \r\n        } else {\r\n          console.warn(\"Empty or invalid people data\");\r\n        }\r\n      } catch (error) {\r\n        console.error('Error loading family tree:', error);\r\n      }\r\n    };\r\n\r\n    loadFamilyTree();\r\n  }, []);\r\n\r\n  if (!familyTree) return <div>Loading...</div>;\r\n\r\n  return (\r\n    <div id=\"treeWrapper\" style={{ width: '100vw', height: '100vh' }}>\r\n      <Tree\r\n  data={familyTree}\r\n  orientation=\"vertical\"\r\n  width={1000}\r\n  height={800}\r\n  pathFunc=\"step\"\r\n  renderCustomNodeElement={({ nodeDatum }) => (\r\n    <g>\r\n      {/* Rectangle as the background */}\r\n      <rect\r\n        x=\"-50\" // Adjust X position\r\n        y=\"-20\" // Adjust Y position\r\n        width=\"100\" // Width of the rectangle\r\n        height=\"40\" // Height of the rectangle\r\n        fill=\"lightblue\" // Background color\r\n        stroke=\"black\" // Border color\r\n        strokeWidth=\"2\" // Border width\r\n        rx=\"10\" // Rounded corners\r\n      />\r\n      {/* Name text inside the rectangle */}\r\n      <text\r\n        x=\"0\" // Center the text horizontally\r\n        y=\"5\" // Adjust text position vertically\r\n        fontSize=\"24\"\r\n        textAnchor=\"middle\" // Align text to the center\r\n        fill=\"black\" // Text color\r\n      >\r\n        {nodeDatum.name}\r\n      </text>\r\n    </g>\r\n  )}\r\n\r\n/>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FamilyTree;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}